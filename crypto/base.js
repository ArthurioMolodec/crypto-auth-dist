'use strict';const a0_0x5e1967=a0_0xa837;(function(_0x414bac,_0x5bdfa1){const _0x2bb86d=a0_0xa837,_0x44f842=_0x414bac();while(!![]){try{const _0x24c4cb=-parseInt(_0x2bb86d(0x1e5))/0x1+-parseInt(_0x2bb86d(0x1f9))/0x2*(-parseInt(_0x2bb86d(0x1e4))/0x3)+parseInt(_0x2bb86d(0x1e9))/0x4*(-parseInt(_0x2bb86d(0x1e3))/0x5)+parseInt(_0x2bb86d(0x1d3))/0x6*(-parseInt(_0x2bb86d(0x1dc))/0x7)+-parseInt(_0x2bb86d(0x1f0))/0x8+parseInt(_0x2bb86d(0x1d6))/0x9*(-parseInt(_0x2bb86d(0x1df))/0xa)+parseInt(_0x2bb86d(0x1e1))/0xb;if(_0x24c4cb===_0x5bdfa1)break;else _0x44f842['push'](_0x44f842['shift']());}catch(_0x1024e4){_0x44f842['push'](_0x44f842['shift']());}}}(a0_0x2cec,0xc7242));Object['defineProperty'](exports,a0_0x5e1967(0x1f4),{'value':!![]}),exports['BaseCryptoAuth']=exports['BadRequestException']=exports[a0_0x5e1967(0x1db)]=exports[a0_0x5e1967(0x1f7)]=void 0x0;function a0_0x2cec(){const _0x29b7ca=['\x0a\x0aThis\x20request\x20will\x20not\x20trigger\x20a\x20blockchain\x20transaction\x20or\x20cost\x20any\x20gas\x20fees.','6161787ySqldc','name','validateAddress','timestamp','endsWith','UnauthorizedException','14kypevq','now','generateNonce','20igfQyh','\x0aExpires:\x20','55739497GawKmC','buildChallengeMessage','5xKTvnC','3cTcOXH','1426582QCxyNh','crypto','startsWith','parseChallengeMessage','1477444PWtWMO','This\x20request\x20will\x20not\x20trigger\x20a\x20blockchain\x20transaction\x20or\x20cost\x20any\x20gas\x20fees.','Invalid\x20challenge\x20message\x20format','verifySignature','Data\x20is\x20not\x20correct','Please\x20sign\x20this\x20message\x20to\x20authenticate\x20with\x20your\x20wallet.\x0a\x0aAddress:\x20','generateChallenge','8717872svNkvP','verifyResponse','BadRequestException','expiresAt','__esModule','match','toString','PublicException','\x0aTimestamp:\x20','3094380WzNWdX','Please\x20sign\x20this\x20message\x20to\x20authenticate\x20with\x20your\x20wallet.','address','4631316hXxyZG','\x0aNonce:\x20'];a0_0x2cec=function(){return _0x29b7ca;};return a0_0x2cec();}const crypto_1=require(a0_0x5e1967(0x1e6));class PublicException extends Error{constructor(_0x56ba19){const _0x31e876=a0_0x5e1967;super(_0x56ba19),this[_0x31e876(0x1d7)]='PublicException';}}exports[a0_0x5e1967(0x1f7)]=PublicException;class UnauthorizedException extends PublicException{constructor(_0x55a72a){const _0x393b3f=a0_0x5e1967;super(_0x55a72a),this[_0x393b3f(0x1d7)]=_0x393b3f(0x1db);}}exports[a0_0x5e1967(0x1db)]=UnauthorizedException;function a0_0xa837(_0x3d802e,_0x4b9788){const _0x2cec60=a0_0x2cec();return a0_0xa837=function(_0xa837e0,_0x3a0b1d){_0xa837e0=_0xa837e0-0x1d1;let _0x121b50=_0x2cec60[_0xa837e0];return _0x121b50;},a0_0xa837(_0x3d802e,_0x4b9788);}class BadRequestException extends PublicException{constructor(_0x20c1c6){const _0x3d662=a0_0x5e1967;super(_0x20c1c6),this[_0x3d662(0x1d7)]=_0x3d662(0x1f2);}}exports[a0_0x5e1967(0x1f2)]=BadRequestException;const exp=0xf*0x3c*0x3e8;class BaseCryptoAuth{['verifySignature'](_0x117de6){throw new Error('Method\x20not\x20implemented.');}[a0_0x5e1967(0x1d8)](_0x173c76){throw new Error('Method\x20not\x20implemented.');}async[a0_0x5e1967(0x1ef)](_0x503c55){const _0x581656=a0_0x5e1967,_0x5b2e84=this[_0x581656(0x1de)](),_0x56cf78=Date['now'](),_0x2fbf53=_0x56cf78+exp,_0x39b573=this['buildChallengeMessage'](_0x503c55,_0x5b2e84,_0x56cf78,_0x2fbf53);return{'message':_0x39b573,'nonce':_0x5b2e84,'timestamp':_0x56cf78,'expiresAt':_0x2fbf53};}async[a0_0x5e1967(0x1f1)](_0x7b2bc9){const _0x31030e=a0_0x5e1967,{message:_0x2ce8ec,address:_0x3bc308,signature:_0x19f75b,publicKey:_0x42b836}=_0x7b2bc9,_0x52eba5=this[_0x31030e(0x1e8)](_0x2ce8ec);if(_0x52eba5[_0x31030e(0x1d2)]!==_0x3bc308||_0x52eba5[_0x31030e(0x1f3)]<Date[_0x31030e(0x1dd)]()||_0x52eba5[_0x31030e(0x1d9)]>Date['now']()||_0x52eba5[_0x31030e(0x1f3)]-_0x52eba5[_0x31030e(0x1d9)]!==exp)throw new UnauthorizedException(_0x31030e(0x1ed));const _0x89b94b=this['validateAddress'](_0x3bc308)&&await this[_0x31030e(0x1ec)]({'address':_0x3bc308,'signature':_0x19f75b,'message':_0x2ce8ec,'publicKey':_0x42b836});if(!_0x89b94b)return{'status':_0x89b94b};return{'status':_0x89b94b,'address':_0x52eba5[_0x31030e(0x1d2)]};}[a0_0x5e1967(0x1de)](){const _0x4ef7d6=a0_0x5e1967;return(0x0,crypto_1['randomBytes'])(0x10)[_0x4ef7d6(0x1f6)]('hex');}[a0_0x5e1967(0x1e2)](_0xfa13f8,_0x30beb0,_0x3a0fdf,_0x421660){const _0x41ac84=a0_0x5e1967;return _0x41ac84(0x1ee)+_0xfa13f8+_0x41ac84(0x1d4)+_0x30beb0+_0x41ac84(0x1f8)+_0x3a0fdf+_0x41ac84(0x1e0)+_0x421660+_0x41ac84(0x1d5);}[a0_0x5e1967(0x1e8)](_0x273a4f){const _0x4e66be=a0_0x5e1967,_0x2d09fb=_0x273a4f[_0x4e66be(0x1f5)](/Address: ([A-Fa-f0-9x]+)/),_0x4039b8=_0x273a4f['match'](/Nonce: ([a-f0-9]+)/),_0x2abf9f=_0x273a4f[_0x4e66be(0x1f5)](/Timestamp: (\d+)/),_0xe4a061=_0x273a4f[_0x4e66be(0x1f5)](/Expires: (\d+)/);if(!_0x273a4f[_0x4e66be(0x1e7)](_0x4e66be(0x1d1)))throw new BadRequestException(_0x4e66be(0x1eb));if(!_0x273a4f[_0x4e66be(0x1da)](_0x4e66be(0x1ea)))throw new BadRequestException(_0x4e66be(0x1eb));if(!_0x2d09fb||!_0x4039b8||!_0x2abf9f||!_0xe4a061)throw new BadRequestException(_0x4e66be(0x1eb));return{'address':_0x2d09fb[0x1],'nonce':_0x4039b8[0x1],'timestamp':parseInt(_0x2abf9f[0x1]),'expiresAt':parseInt(_0xe4a061[0x1])};}}exports['BaseCryptoAuth']=BaseCryptoAuth;