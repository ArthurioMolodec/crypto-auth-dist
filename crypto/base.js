'use strict';const a0_0x4af4ff=a0_0x51b8;(function(_0xc95ab7,_0x25921f){const _0x39e336=a0_0x51b8,_0x460dc3=_0xc95ab7();while(!![]){try{const _0x2fbb3d=parseInt(_0x39e336(0xc6))/0x1+parseInt(_0x39e336(0xe5))/0x2*(parseInt(_0x39e336(0xc4))/0x3)+parseInt(_0x39e336(0xd6))/0x4+parseInt(_0x39e336(0xe3))/0x5+parseInt(_0x39e336(0xe6))/0x6*(-parseInt(_0x39e336(0xeb))/0x7)+-parseInt(_0x39e336(0xdd))/0x8+-parseInt(_0x39e336(0xe1))/0x9*(parseInt(_0x39e336(0xd5))/0xa);if(_0x2fbb3d===_0x25921f)break;else _0x460dc3['push'](_0x460dc3['shift']());}catch(_0x13eb06){_0x460dc3['push'](_0x460dc3['shift']());}}}(a0_0x3343,0x4076d));Object[a0_0x4af4ff(0xc9)](exports,a0_0x4af4ff(0xc7),{'value':!![]}),exports['BaseCryptoAuth']=exports[a0_0x4af4ff(0xd4)]=exports[a0_0x4af4ff(0xce)]=exports['PublicException']=void 0x0;const crypto_1=require(a0_0x4af4ff(0xe8));function a0_0x51b8(_0x3723db,_0x1b6fb8){const _0x33437a=a0_0x3343();return a0_0x51b8=function(_0x51b8ee,_0x3874b5){_0x51b8ee=_0x51b8ee-0xc3;let _0x571d9d=_0x33437a[_0x51b8ee];return _0x571d9d;},a0_0x51b8(_0x3723db,_0x1b6fb8);}class PublicException extends Error{constructor(_0x5a59aa){const _0x25b632=a0_0x4af4ff;super(_0x5a59aa),this[_0x25b632(0xed)]=_0x25b632(0xd9);}}exports['PublicException']=PublicException;class UnauthorizedException extends PublicException{constructor(_0x4bfcfa){const _0x7cab8e=a0_0x4af4ff;super(_0x4bfcfa),this['name']=_0x7cab8e(0xce);}}function a0_0x3343(){const _0x3c83a3=['crypto','match','validateAddress','924623LsMkIt','verifyResponse','name','Method\x20not\x20implemented.','Invalid\x20challenge\x20message\x20format','endsWith','index','896823GTrdVJ','parseChallengeMessage','233910HWHxIa','__esModule','slice','defineProperty','Data\x20is\x20not\x20correct','\x0aExpires:\x20','address','randomBytes','UnauthorizedException','\x0aTimestamp:\x20','additional_info','message','lastIndexOf','\x0aNonce:\x20','BadRequestException','790mcNRkg','1027972lsRwgw','expiresAt','trim','PublicException','verifySignature','This\x20request\x20will\x20not\x20trigger\x20a\x20blockchain\x20transaction\x20or\x20cost\x20any\x20gas\x20fees.','length','2664624YSVNyF','hex','buildChallengeMessage','now','22707ZNnfpx','\x0a\x0aAddress:\x20','693425HlmCif','timestamp','2ktbsyV','6RcZuXk','generateNonce'];a0_0x3343=function(){return _0x3c83a3;};return a0_0x3343();}exports['UnauthorizedException']=UnauthorizedException;class BadRequestException extends PublicException{constructor(_0x24d7ea){const _0x4808eb=a0_0x4af4ff;super(_0x24d7ea),this[_0x4808eb(0xed)]='BadRequestException';}}exports['BadRequestException']=BadRequestException;const exp=0x5*0x3c*0x3e8,msgHeader='Please\x20sign\x20this\x20message\x20to\x20authenticate\x20with\x20your\x20wallet.',msgBottom=a0_0x4af4ff(0xdb);class BaseCryptoAuth{[a0_0x4af4ff(0xda)](_0x3eeae3){throw new Error('Method\x20not\x20implemented.');}[a0_0x4af4ff(0xea)](_0x4e81ef){const _0x4c3dab=a0_0x4af4ff;throw new Error(_0x4c3dab(0xee));}async['generateChallenge'](_0x40419c){const _0x362f1c=a0_0x4af4ff,_0x54698b=this[_0x362f1c(0xe7)](),_0x1b97c6=Date[_0x362f1c(0xe0)](),_0x43925d=_0x1b97c6+exp,_0x48e3ce=this[_0x362f1c(0xdf)](_0x40419c[_0x362f1c(0xcc)],_0x54698b,_0x1b97c6,_0x43925d,_0x40419c[_0x362f1c(0xd0)]);return{'message':_0x48e3ce,'nonce':_0x54698b,'timestamp':_0x1b97c6,'expiresAt':_0x43925d};}async[a0_0x4af4ff(0xec)](_0x1d0123){const _0x28f3bb=a0_0x4af4ff,{address:_0x21fb57,signature:_0x38fa15,publicKey:_0x49c509,challenge:_0x5ed56e,message:_0x2886e5}=_0x1d0123,_0x33d541=_0x5ed56e[_0x28f3bb(0xd1)]??_0x2886e5,_0x14abad=this[_0x28f3bb(0xc5)](_0x33d541);if(_0x14abad[_0x28f3bb(0xcc)]!==_0x21fb57||_0x14abad[_0x28f3bb(0xd7)]<Date[_0x28f3bb(0xe0)]()||_0x14abad[_0x28f3bb(0xe4)]>Date[_0x28f3bb(0xe0)]()||_0x14abad['expiresAt']-_0x14abad['timestamp']!==exp)throw new UnauthorizedException(_0x28f3bb(0xca));const _0x3c9d6d=this[_0x28f3bb(0xea)](_0x21fb57)&&await this['verifySignature']({'address':_0x21fb57,'signature':_0x38fa15,'message':_0x33d541,'publicKey':_0x49c509});if(!_0x3c9d6d)return{'status':_0x3c9d6d};return{'status':_0x3c9d6d,'address':_0x14abad['address']};}['generateNonce'](){const _0x298f8f=a0_0x4af4ff;return(0x0,crypto_1[_0x298f8f(0xcd)])(0x10)['toString'](_0x298f8f(0xde));}[a0_0x4af4ff(0xdf)](_0x18d732,_0x581f4d,_0x3b4cf7,_0x4fa68d,_0x38b137){const _0x4d44a5=a0_0x4af4ff;return msgHeader+_0x4d44a5(0xe2)+_0x18d732+_0x4d44a5(0xd3)+_0x581f4d+_0x4d44a5(0xcf)+_0x3b4cf7+_0x4d44a5(0xcb)+_0x4fa68d+'\x0a'+(_0x38b137?'\x0a'+_0x38b137:'')+'\x0a\x0a'+msgBottom;}[a0_0x4af4ff(0xc5)](_0x15fc93){const _0x249dbb=a0_0x4af4ff,_0x5a3f48=_0x15fc93[_0x249dbb(0xe9)](/Address: ([A-Fa-f0-9x]+)/),_0x442f3c=_0x15fc93[_0x249dbb(0xe9)](/Nonce: ([a-f0-9]+)/),_0x1d8185=_0x15fc93[_0x249dbb(0xe9)](/Timestamp: (\d+)/),_0x2c7ea2=_0x15fc93[_0x249dbb(0xe9)](/Expires: (\d+)/);if(!_0x15fc93['startsWith'](msgHeader))throw new BadRequestException('Invalid\x20challenge\x20message\x20format');if(!_0x15fc93[_0x249dbb(0xf0)](msgBottom))throw new BadRequestException(_0x249dbb(0xef));if(!_0x5a3f48||!_0x442f3c||!_0x1d8185||!_0x2c7ea2||_0x2c7ea2[_0x249dbb(0xc3)]===undefined)throw new BadRequestException(_0x249dbb(0xef));const _0x193847=_0x15fc93[_0x249dbb(0xc8)](_0x2c7ea2[_0x249dbb(0xc3)]+_0x2c7ea2[0x0][_0x249dbb(0xdc)],_0x15fc93[_0x249dbb(0xd2)](msgBottom))[_0x249dbb(0xd8)]();return{'address':_0x5a3f48[0x1],'nonce':_0x442f3c[0x1],'timestamp':parseInt(_0x1d8185[0x1]),'expiresAt':parseInt(_0x2c7ea2[0x1]),'additional_info':_0x193847};}}exports['BaseCryptoAuth']=BaseCryptoAuth;