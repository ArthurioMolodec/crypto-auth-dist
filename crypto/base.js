'use strict';const a0_0x3fcfaf=a0_0x3616;(function(_0x3973e9,_0x34603f){const _0x3bf2ba=a0_0x3616,_0xfae313=_0x3973e9();while(!![]){try{const _0x40b52c=parseInt(_0x3bf2ba(0xd3))/0x1+parseInt(_0x3bf2ba(0xd5))/0x2*(parseInt(_0x3bf2ba(0xe1))/0x3)+parseInt(_0x3bf2ba(0xe2))/0x4*(parseInt(_0x3bf2ba(0xfd))/0x5)+-parseInt(_0x3bf2ba(0xf4))/0x6+-parseInt(_0x3bf2ba(0xe0))/0x7+-parseInt(_0x3bf2ba(0xcf))/0x8*(parseInt(_0x3bf2ba(0xd0))/0x9)+-parseInt(_0x3bf2ba(0xd9))/0xa*(parseInt(_0x3bf2ba(0xe3))/0xb);if(_0x40b52c===_0x34603f)break;else _0xfae313['push'](_0xfae313['shift']());}catch(_0x24aa3f){_0xfae313['push'](_0xfae313['shift']());}}}(a0_0x3c42,0x65b0c));Object[a0_0x3fcfaf(0xed)](exports,a0_0x3fcfaf(0xd4),{'value':!![]}),exports['BaseCryptoAuth']=exports[a0_0x3fcfaf(0xfc)]=exports[a0_0x3fcfaf(0xea)]=exports['PublicException']=void 0x0;const crypto_1=require(a0_0x3fcfaf(0xec));class PublicException extends Error{constructor(_0x5b3a81){const _0x4cd8b1=a0_0x3fcfaf;super(_0x5b3a81),this['name']=_0x4cd8b1(0xdd);}}exports[a0_0x3fcfaf(0xdd)]=PublicException;class UnauthorizedException extends PublicException{constructor(_0x1a6c21){const _0x5452d7=a0_0x3fcfaf;super(_0x1a6c21),this[_0x5452d7(0xf7)]='UnauthorizedException';}}exports['UnauthorizedException']=UnauthorizedException;function a0_0x3c42(){const _0x169fb7=['3cnfHvK','16dSJVuk','2563IiHVup','slice','randomBytes','timestamp','verifySignature','\x0aTimestamp:\x20','now','UnauthorizedException','match','crypto','defineProperty','Please\x20sign\x20this\x20message\x20to\x20authenticate\x20with\x20your\x20wallet.','validateAddress','address','generateNonce','hex','generateChallenge','1979814rxtzRq','buildChallengeMessage','BaseCryptoAuth','name','\x0a\x0aAddress:\x20','index','additional_info','Invalid\x20challenge\x20message\x20format','BadRequestException','916410GkVXkO','1712fSmQfg','28503unctus','parseChallengeMessage','\x0aNonce:\x20','569557XJaHSg','__esModule','1097302dWutei','trim','Data\x20is\x20not\x20correct','verifyResponse','10130SIqARO','Method\x20not\x20implemented.','endsWith','expiresAt','PublicException','\x0aExpires:\x20','lastIndexOf','1337532WOrCVC'];a0_0x3c42=function(){return _0x169fb7;};return a0_0x3c42();}class BadRequestException extends PublicException{constructor(_0x27d747){const _0x57a653=a0_0x3fcfaf;super(_0x27d747),this[_0x57a653(0xf7)]=_0x57a653(0xfc);}}exports['BadRequestException']=BadRequestException;const exp=0x5*0x3c*0x3e8,msgHeader=a0_0x3fcfaf(0xee),msgBottom='This\x20request\x20will\x20not\x20trigger\x20a\x20blockchain\x20transaction\x20or\x20cost\x20any\x20gas\x20fees.';function a0_0x3616(_0x1383a0,_0x3ac102){const _0x3c428e=a0_0x3c42();return a0_0x3616=function(_0x3616d5,_0x3a6856){_0x3616d5=_0x3616d5-0xcf;let _0x43e7bd=_0x3c428e[_0x3616d5];return _0x43e7bd;},a0_0x3616(_0x1383a0,_0x3ac102);}class BaseCryptoAuth{[a0_0x3fcfaf(0xe7)](_0x59bbae){throw new Error('Method\x20not\x20implemented.');}[a0_0x3fcfaf(0xef)](_0x4ac044){const _0xeef77c=a0_0x3fcfaf;throw new Error(_0xeef77c(0xda));}async[a0_0x3fcfaf(0xf3)](_0x5c03c0){const _0x4d6550=a0_0x3fcfaf,_0x180fe9=this[_0x4d6550(0xf1)](),_0x580717=Date[_0x4d6550(0xe9)](),_0x42c315=_0x580717+exp,_0x4651bb=this[_0x4d6550(0xf5)](_0x5c03c0['address'],_0x180fe9,_0x580717,_0x42c315,_0x5c03c0[_0x4d6550(0xfa)]);return{'message':_0x4651bb,'nonce':_0x180fe9,'timestamp':_0x580717,'expiresAt':_0x42c315};}async[a0_0x3fcfaf(0xd8)](_0x2a0a47){const _0x3cfbd8=a0_0x3fcfaf,{address:_0x35ae62,signature:_0x3a1189,publicKey:_0x4284df,challenge:_0x25381d,message:_0x16f591}=_0x2a0a47,_0x2f56db=_0x25381d?.['message']??_0x16f591,_0x5eb531=this[_0x3cfbd8(0xd1)](_0x2f56db);if(_0x5eb531[_0x3cfbd8(0xf0)]!==_0x35ae62||_0x5eb531[_0x3cfbd8(0xdc)]<Date[_0x3cfbd8(0xe9)]()||_0x5eb531['timestamp']>Date['now']()||_0x5eb531[_0x3cfbd8(0xdc)]-_0x5eb531[_0x3cfbd8(0xe6)]!==exp)throw new UnauthorizedException(_0x3cfbd8(0xd7));const _0x32ec4c=this[_0x3cfbd8(0xef)](_0x35ae62)&&await this[_0x3cfbd8(0xe7)]({'address':_0x35ae62,'signature':_0x3a1189,'message':_0x2f56db,'publicKey':_0x4284df});if(!_0x32ec4c)return{'status':_0x32ec4c};return{'status':_0x32ec4c,'address':_0x5eb531[_0x3cfbd8(0xf0)]};}[a0_0x3fcfaf(0xf1)](){const _0x163709=a0_0x3fcfaf;return(0x0,crypto_1[_0x163709(0xe5)])(0x10)['toString'](_0x163709(0xf2));}[a0_0x3fcfaf(0xf5)](_0x2c2cec,_0x21fb9e,_0x47767c,_0x59a8e9,_0x337545){const _0x243e25=a0_0x3fcfaf;return msgHeader+_0x243e25(0xf8)+_0x2c2cec+_0x243e25(0xd2)+_0x21fb9e+_0x243e25(0xe8)+_0x47767c+_0x243e25(0xde)+_0x59a8e9+'\x0a'+(_0x337545?'\x0a'+_0x337545:'')+'\x0a\x0a'+msgBottom;}[a0_0x3fcfaf(0xd1)](_0x1a6f3b){const _0x2d6693=a0_0x3fcfaf,_0x31617a=_0x1a6f3b[_0x2d6693(0xeb)](/Address: ([A-Fa-f0-9x]+)/),_0x2e4455=_0x1a6f3b[_0x2d6693(0xeb)](/Nonce: ([a-f0-9]+)/),_0x18d025=_0x1a6f3b[_0x2d6693(0xeb)](/Timestamp: (\d+)/),_0x31e4a3=_0x1a6f3b[_0x2d6693(0xeb)](/Expires: (\d+)/);if(!_0x1a6f3b['startsWith'](msgHeader))throw new BadRequestException(_0x2d6693(0xfb));if(!_0x1a6f3b[_0x2d6693(0xdb)](msgBottom))throw new BadRequestException('Invalid\x20challenge\x20message\x20format');if(!_0x31617a||!_0x2e4455||!_0x18d025||!_0x31e4a3||_0x31e4a3['index']===undefined)throw new BadRequestException(_0x2d6693(0xfb));const _0x36b9a3=_0x1a6f3b[_0x2d6693(0xe4)](_0x31e4a3[_0x2d6693(0xf9)]+_0x31e4a3[0x0]['length'],_0x1a6f3b[_0x2d6693(0xdf)](msgBottom))[_0x2d6693(0xd6)]();return{'address':_0x31617a[0x1],'nonce':_0x2e4455[0x1],'timestamp':parseInt(_0x18d025[0x1]),'expiresAt':parseInt(_0x31e4a3[0x1]),'additional_info':_0x36b9a3};}}exports[a0_0x3fcfaf(0xf6)]=BaseCryptoAuth;