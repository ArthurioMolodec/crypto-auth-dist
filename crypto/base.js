'use strict';const a0_0x34eae7=a0_0xe383;(function(_0x361cd0,_0x5943a0){const _0x4b28b7=a0_0xe383,_0x47235a=_0x361cd0();while(!![]){try{const _0x583838=parseInt(_0x4b28b7(0x20b))/0x1*(parseInt(_0x4b28b7(0x1f0))/0x2)+parseInt(_0x4b28b7(0x1ee))/0x3+parseInt(_0x4b28b7(0x1ea))/0x4*(parseInt(_0x4b28b7(0x202))/0x5)+-parseInt(_0x4b28b7(0x1e1))/0x6+parseInt(_0x4b28b7(0x1f2))/0x7*(-parseInt(_0x4b28b7(0x1ec))/0x8)+-parseInt(_0x4b28b7(0x1f7))/0x9*(parseInt(_0x4b28b7(0x209))/0xa)+-parseInt(_0x4b28b7(0x203))/0xb*(-parseInt(_0x4b28b7(0x1fa))/0xc);if(_0x583838===_0x5943a0)break;else _0x47235a['push'](_0x47235a['shift']());}catch(_0x1c9612){_0x47235a['push'](_0x47235a['shift']());}}}(a0_0x5354,0x407b1));Object[a0_0x34eae7(0x1fb)](exports,a0_0x34eae7(0x1eb),{'value':!![]}),exports[a0_0x34eae7(0x1e5)]=exports[a0_0x34eae7(0x1e4)]=exports[a0_0x34eae7(0x200)]=exports['PublicException']=void 0x0;function a0_0xe383(_0x314739,_0x4cda32){const _0x5354c6=a0_0x5354();return a0_0xe383=function(_0xe383e3,_0x48f792){_0xe383e3=_0xe383e3-0x1e0;let _0x738159=_0x5354c6[_0xe383e3];return _0x738159;},a0_0xe383(_0x314739,_0x4cda32);}const crypto_1=require(a0_0x34eae7(0x1fd));class PublicException extends Error{constructor(_0x24e4f8){const _0xe2877=a0_0x34eae7;super(_0x24e4f8),this[_0xe2877(0x1fe)]=_0xe2877(0x1ef);}}exports['PublicException']=PublicException;class UnauthorizedException extends PublicException{constructor(_0x25493d){const _0x29d540=a0_0x34eae7;super(_0x25493d),this[_0x29d540(0x1fe)]=_0x29d540(0x200);}}exports[a0_0x34eae7(0x200)]=UnauthorizedException;class BadRequestException extends PublicException{constructor(_0x544041){const _0x51e204=a0_0x34eae7;super(_0x544041),this[_0x51e204(0x1fe)]=_0x51e204(0x1e4);}}exports['BadRequestException']=BadRequestException;function a0_0x5354(){const _0x2194b6=['message','38HAhcAv','verifyResponse','verifySignature','903498wQYLDN','Please\x20sign\x20this\x20message\x20to\x20authenticate\x20with\x20your\x20wallet.','match','BadRequestException','BaseCryptoAuth','startsWith','now','length','randomBytes','4btknlQ','__esModule','491720GqAYhU','Method\x20not\x20implemented.','120921TSPILA','PublicException','19266nZiGsG','additional_info','35LFpXZE','generateNonce','buildChallengeMessage','slice','generateChallenge','9XtFFjS','This\x20request\x20will\x20not\x20trigger\x20a\x20blockchain\x20transaction\x20or\x20cost\x20any\x20gas\x20fees.','address','4808748kqOtCp','defineProperty','\x0a\x0aAddress:\x20','crypto','name','trim','UnauthorizedException','toString','88205TXaHcb','22uDedXj','validateAddress','index','Invalid\x20challenge\x20message\x20format','parseChallengeMessage','timestamp','5034390jWAWpj'];a0_0x5354=function(){return _0x2194b6;};return a0_0x5354();}const exp=0x5*0x3c*0x3e8,msgHeader=a0_0x34eae7(0x1e2),msgBottom=a0_0x34eae7(0x1f8);class BaseCryptoAuth{[a0_0x34eae7(0x1e0)](_0x319928){throw new Error('Method\x20not\x20implemented.');}[a0_0x34eae7(0x204)](_0x286c91){const _0x20b084=a0_0x34eae7;throw new Error(_0x20b084(0x1ed));}async[a0_0x34eae7(0x1f6)](_0x4a94c0){const _0x55e1fb=a0_0x34eae7,_0x19cdff=this['generateNonce'](),_0x4c6caf=Date[_0x55e1fb(0x1e7)](),_0x2aef93=_0x4c6caf+exp,_0x17b9e8=this[_0x55e1fb(0x1f4)](_0x4a94c0[_0x55e1fb(0x1f9)],_0x19cdff,_0x4c6caf,_0x2aef93,_0x4a94c0[_0x55e1fb(0x1f1)]);return{'message':_0x17b9e8,'nonce':_0x19cdff,'timestamp':_0x4c6caf,'expiresAt':_0x2aef93};}async[a0_0x34eae7(0x20c)](_0x3542f1){const _0x1e8da5=a0_0x34eae7,{address:_0x4f9dac,signature:_0x3fd891,publicKey:_0x395dc0,challenge:_0x250a70,message:_0x3a668a}=_0x3542f1,_0x336d1c=_0x250a70[_0x1e8da5(0x20a)]??_0x3a668a,_0x228e62=this[_0x1e8da5(0x207)](_0x336d1c);if(_0x228e62[_0x1e8da5(0x1f9)]!==_0x4f9dac||_0x228e62['expiresAt']<Date[_0x1e8da5(0x1e7)]()||_0x228e62[_0x1e8da5(0x208)]>Date['now']()||_0x228e62['expiresAt']-_0x228e62[_0x1e8da5(0x208)]!==exp)throw new UnauthorizedException('Data\x20is\x20not\x20correct');const _0x2ea1d3=this['validateAddress'](_0x4f9dac)&&await this[_0x1e8da5(0x1e0)]({'address':_0x4f9dac,'signature':_0x3fd891,'message':_0x336d1c,'publicKey':_0x395dc0});if(!_0x2ea1d3)return{'status':_0x2ea1d3};return{'status':_0x2ea1d3,'address':_0x228e62[_0x1e8da5(0x1f9)]};}[a0_0x34eae7(0x1f3)](){const _0x1e433b=a0_0x34eae7;return(0x0,crypto_1[_0x1e433b(0x1e9)])(0x10)[_0x1e433b(0x201)]('hex');}[a0_0x34eae7(0x1f4)](_0x339d48,_0x414ed5,_0x41b776,_0x23c6d5,_0x2857e7){const _0x3f50dc=a0_0x34eae7;return msgHeader+_0x3f50dc(0x1fc)+_0x339d48+'\x0aNonce:\x20'+_0x414ed5+'\x0aTimestamp:\x20'+_0x41b776+'\x0aExpires:\x20'+_0x23c6d5+'\x0a'+(_0x2857e7?'\x0a'+_0x2857e7:'')+'\x0a\x0a'+msgBottom;}[a0_0x34eae7(0x207)](_0x357753){const _0xe90253=a0_0x34eae7,_0x4e6b14=_0x357753[_0xe90253(0x1e3)](/Address: ([A-Fa-f0-9x]+)/),_0x59aacb=_0x357753[_0xe90253(0x1e3)](/Nonce: ([a-f0-9]+)/),_0x236aa2=_0x357753['match'](/Timestamp: (\d+)/),_0x337f4d=_0x357753['match'](/Expires: (\d+)/);if(!_0x357753[_0xe90253(0x1e6)](msgHeader))throw new BadRequestException(_0xe90253(0x206));if(!_0x357753['endsWith'](msgBottom))throw new BadRequestException(_0xe90253(0x206));if(!_0x4e6b14||!_0x59aacb||!_0x236aa2||!_0x337f4d||_0x337f4d['index']===undefined)throw new BadRequestException(_0xe90253(0x206));const _0x3609ad=_0x357753[_0xe90253(0x1f5)](_0x337f4d[_0xe90253(0x205)]+_0x337f4d[0x0][_0xe90253(0x1e8)],_0x357753['lastIndexOf'](msgBottom))[_0xe90253(0x1ff)]();return{'address':_0x4e6b14[0x1],'nonce':_0x59aacb[0x1],'timestamp':parseInt(_0x236aa2[0x1]),'expiresAt':parseInt(_0x337f4d[0x1]),'additional_info':_0x3609ad};}}exports[a0_0x34eae7(0x1e5)]=BaseCryptoAuth;