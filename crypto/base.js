'use strict';const a0_0x47b450=a0_0x5628;(function(_0x20462b,_0x311dc4){const _0x4f5d01=a0_0x5628,_0x64187c=_0x20462b();while(!![]){try{const _0x41d0f6=parseInt(_0x4f5d01(0x98))/0x1+-parseInt(_0x4f5d01(0x89))/0x2+-parseInt(_0x4f5d01(0x9a))/0x3*(-parseInt(_0x4f5d01(0xa8))/0x4)+-parseInt(_0x4f5d01(0x9b))/0x5+parseInt(_0x4f5d01(0x90))/0x6*(-parseInt(_0x4f5d01(0x96))/0x7)+parseInt(_0x4f5d01(0xab))/0x8*(-parseInt(_0x4f5d01(0x9f))/0x9)+parseInt(_0x4f5d01(0x93))/0xa;if(_0x41d0f6===_0x311dc4)break;else _0x64187c['push'](_0x64187c['shift']());}catch(_0x5dbba3){_0x64187c['push'](_0x64187c['shift']());}}}(a0_0x1ef8,0x44abc));function a0_0x5628(_0x54d634,_0x398202){const _0x1ef841=a0_0x1ef8();return a0_0x5628=function(_0x56280e,_0x44869f){_0x56280e=_0x56280e-0x88;let _0x1e1e9c=_0x1ef841[_0x56280e];return _0x1e1e9c;},a0_0x5628(_0x54d634,_0x398202);}Object['defineProperty'](exports,a0_0x47b450(0xa4),{'value':!![]}),exports[a0_0x47b450(0xa5)]=void 0x0;function a0_0x1ef8(){const _0x318c32=['verifyResponse','47341gKdLJR','Method\x20not\x20implemented.','44635SqrjgU','endsWith','3IwRdWB','1599490RszwhG','match','BadRequestException','Invalid\x20challenge\x20message\x20format','4041KpNvtJ','@nestjs/common','startsWith','buildChallengeMessage','timestamp','__esModule','BaseCryptoAuth','now','hex','1856116JWWshp','\x0a\x0aThis\x20request\x20will\x20not\x20trigger\x20a\x20blockchain\x20transaction\x20or\x20cost\x20any\x20gas\x20fees.','crypto','2888gLNdsg','\x0aTimestamp:\x20','90138lWHpqP','Data\x20is\x20not\x20correct','validateAddress','parseChallengeMessage','randomBytes','generateNonce','address','402tXrvrN','\x0aExpires:\x20','\x0aNonce:\x20','7527890SJgaGn','verifySignature'];a0_0x1ef8=function(){return _0x318c32;};return a0_0x1ef8();}const common_1=require(a0_0x47b450(0xa0)),crypto_1=require(a0_0x47b450(0xaa)),exp=0xf*0x3c*0x3e8;class BaseCryptoAuth{[a0_0x47b450(0x94)](_0x2f90d1){const _0x11dea2=a0_0x47b450;throw new Error(_0x11dea2(0x97));}['validateAddress'](_0x43286d){const _0x5eea91=a0_0x47b450;throw new Error(_0x5eea91(0x97));}async['generateChallenge'](_0x259ccd){const _0x522123=a0_0x47b450,_0x3e1bbb=this[_0x522123(0x8e)](),_0x13ba35=Date[_0x522123(0xa6)](),_0x2d35c3=_0x13ba35+exp,_0x16933f=this[_0x522123(0xa2)](_0x259ccd,_0x3e1bbb,_0x13ba35,_0x2d35c3);return{'message':_0x16933f,'nonce':_0x3e1bbb,'timestamp':_0x13ba35,'expiresAt':_0x2d35c3};}async[a0_0x47b450(0x95)](_0xd64515){const _0x5e7cc1=a0_0x47b450;try{const {message:_0x428fb0,address:_0x336c96,signature:_0x51259d,publicKey:_0x4daecd}=_0xd64515,_0x2a439f=this[_0x5e7cc1(0x8c)](_0x428fb0);if(_0x2a439f['address']!==_0x336c96||_0x2a439f['expiresAt']<Date[_0x5e7cc1(0xa6)]()||_0x2a439f[_0x5e7cc1(0xa3)]>Date[_0x5e7cc1(0xa6)]()||_0x2a439f['expiresAt']-_0x2a439f[_0x5e7cc1(0xa3)]!==exp)throw new common_1[(_0x5e7cc1(0x9d))](_0x5e7cc1(0x8a));const _0x392a9f=this[_0x5e7cc1(0x8b)](_0x336c96)&&await this[_0x5e7cc1(0x94)]({'address':_0x336c96,'signature':_0x51259d,'message':_0x428fb0,'publicKey':_0x4daecd});if(!_0x392a9f)return{'status':_0x392a9f};return{'status':_0x392a9f,'address':_0x2a439f[_0x5e7cc1(0x8f)]};}catch(_0x349cc7){throw new common_1[(_0x5e7cc1(0x9d))]('Invalid\x20response\x20format\x20or\x20verification\x20failed');}}[a0_0x47b450(0x8e)](){const _0x158d4b=a0_0x47b450;return(0x0,crypto_1[_0x158d4b(0x8d)])(0x10)['toString'](_0x158d4b(0xa7));}['buildChallengeMessage'](_0x225089,_0x4958c5,_0x55c9fc,_0x31b4a5){const _0x5b5a20=a0_0x47b450;return'Please\x20sign\x20this\x20message\x20to\x20authenticate\x20with\x20your\x20wallet.\x0a\x0aAddress:\x20'+_0x225089+_0x5b5a20(0x92)+_0x4958c5+_0x5b5a20(0x88)+_0x55c9fc+_0x5b5a20(0x91)+_0x31b4a5+_0x5b5a20(0xa9);}[a0_0x47b450(0x8c)](_0x175549){const _0x23697d=a0_0x47b450,_0x22923e=_0x175549['match'](/Address: ([A-Fa-f0-9]+)/),_0x538315=_0x175549[_0x23697d(0x9c)](/Nonce: ([a-f0-9]+)/),_0x277aca=_0x175549[_0x23697d(0x9c)](/Timestamp: (\d+)/),_0xb6c060=_0x175549[_0x23697d(0x9c)](/Expires: (\d+)/);if(!_0x175549[_0x23697d(0xa1)]('Please\x20sign\x20this\x20message\x20to\x20authenticate\x20with\x20your\x20wallet.'))throw new common_1[(_0x23697d(0x9d))](_0x23697d(0x9e));if(!_0x175549[_0x23697d(0x99)]('This\x20request\x20will\x20not\x20trigger\x20a\x20blockchain\x20transaction\x20or\x20cost\x20any\x20gas\x20fees.'))throw new common_1[(_0x23697d(0x9d))](_0x23697d(0x9e));if(!_0x22923e||!_0x538315||!_0x277aca||!_0xb6c060)throw new common_1[(_0x23697d(0x9d))](_0x23697d(0x9e));return{'address':_0x22923e[0x1],'nonce':_0x538315[0x1],'timestamp':parseInt(_0x277aca[0x1]),'expiresAt':parseInt(_0xb6c060[0x1])};}}exports['BaseCryptoAuth']=BaseCryptoAuth;