'use strict';const a10_0xbad57d=a10_0x8b08;(function(_0x85e06b,_0x3fa83a){const _0x5c391d=a10_0x8b08,_0x44d965=_0x85e06b();while(!![]){try{const _0x48ea5b=parseInt(_0x5c391d(0x15d))/0x1+-parseInt(_0x5c391d(0x155))/0x2*(parseInt(_0x5c391d(0x14f))/0x3)+parseInt(_0x5c391d(0x14c))/0x4+-parseInt(_0x5c391d(0x162))/0x5+-parseInt(_0x5c391d(0x14b))/0x6+parseInt(_0x5c391d(0x158))/0x7+-parseInt(_0x5c391d(0x151))/0x8*(-parseInt(_0x5c391d(0x148))/0x9);if(_0x48ea5b===_0x3fa83a)break;else _0x44d965['push'](_0x44d965['shift']());}catch(_0x4eba3e){_0x44d965['push'](_0x44d965['shift']());}}}(a10_0x370d,0x2a878));function a10_0x370d(){const _0x42288c=['defineProperty','success','137671CVXJaT','headers','verifyResponse','getChallenge','name','1370260CyhOYF','status','./crypto/base','CryptoAuthFactory','BadRequestException','responseField','Unauthorized','failWithChallenge','Invalid\x20wallet\x20type','baseCryptoAuth','PublicException','values','crypto','x-address','cryptoAuthFactory','body','./crypto/factory','153UqzIsL','walletVerifier','includes','499506tPoeCN','417016yGqBLT','message','default','12624PoiLID','Strategy','12728JaFmwL','authenticate','json','passport-strategy','2TePqXT','Invalid\x20credentials','address','1867173hGKNsr','walletType','./crypto/constants'];a10_0x370d=function(){return _0x42288c;};return a10_0x370d();}function a10_0x8b08(_0x76c589,_0x129c0b){const _0x370d6b=a10_0x370d();return a10_0x8b08=function(_0x8b0809,_0xb09dac){_0x8b0809=_0x8b0809-0x147;let _0x24e522=_0x370d6b[_0x8b0809];return _0x24e522;},a10_0x8b08(_0x76c589,_0x129c0b);}Object[a10_0xbad57d(0x15b)](exports,'__esModule',{'value':!![]}),exports['Strategy']=void 0x0;const passport_strategy_1=require(a10_0xbad57d(0x154)),factory_1=require(a10_0xbad57d(0x147)),base_1=require(a10_0xbad57d(0x164)),assert=require('assert'),constants_1=require(a10_0xbad57d(0x15a));class CryptoStrategy extends passport_strategy_1[a10_0xbad57d(0x150)]{constructor(_0x32d8dc={}){const _0x5db6a2=a10_0xbad57d;super(),this[_0x5db6a2(0x161)]=_0x5db6a2(0x16e),this['cryptoAuthFactory']=new factory_1[(_0x5db6a2(0x165))](),this[_0x5db6a2(0x16b)]=this[_0x5db6a2(0x170)]['getBaseCryptoAuth'](),this[_0x5db6a2(0x167)]=_0x32d8dc[_0x5db6a2(0x167)]||'response';}async[a10_0xbad57d(0x160)](_0x48db4c){const _0x4180e8=a10_0xbad57d;return this['baseCryptoAuth']['generateChallenge'](_0x48db4c[_0x4180e8(0x15e)][_0x4180e8(0x16f)]);}async['verifyResponse'](_0x296e60,_0x3022cd){const _0x3da2e2=a10_0xbad57d;assert(Object[_0x3da2e2(0x16d)](constants_1['WalletType'])[_0x3da2e2(0x14a)](_0x3022cd[_0x3da2e2(0x159)]),new base_1[(_0x3da2e2(0x166))](_0x3da2e2(0x16a)));const _0x450fe7=this[_0x3da2e2(0x170)][_0x3da2e2(0x149)](_0x3022cd['walletType']),_0x4387a7=await _0x450fe7[_0x3da2e2(0x15f)](_0x3022cd);return{'status':_0x4387a7[_0x3da2e2(0x163)],'user':_0x4387a7['status']?{'address':_0x4387a7[_0x3da2e2(0x157)]}:undefined};}async[a10_0xbad57d(0x152)](_0x54aca8){const _0x486348=a10_0xbad57d,_0x198dc1=_0x54aca8[_0x486348(0x171)]||{},_0x381486=_0x198dc1[this[_0x486348(0x167)]];if(!_0x381486||typeof _0x381486!=='object'){const _0x36e2a5=await this[_0x486348(0x160)](_0x54aca8);return this['failWithChallenge'](_0x54aca8,'Challenge',_0x36e2a5);}try{const {user:_0x4a6067,status:_0x414b7e}=await this[_0x486348(0x15f)](_0x54aca8,_0x381486);if(_0x414b7e&&_0x4a6067)return this[_0x486348(0x15c)](_0x4a6067);return this[_0x486348(0x169)](_0x54aca8,_0x486348(0x156));}catch(_0x319efe){if(_0x319efe instanceof base_1[_0x486348(0x16c)])return this[_0x486348(0x169)](_0x54aca8,_0x319efe[_0x486348(0x14d)]);throw _0x319efe;}}async['failWithChallenge'](_0x2f2974,_0x4ae91a,_0x2d4925){const _0x1ae37c=a10_0xbad57d;return _0x2f2974['res']['status'](0x191)[_0x1ae37c(0x153)]({'challenge':_0x2d4925,'message':_0x4ae91a||_0x1ae37c(0x168)});}}exports[a10_0xbad57d(0x150)]=CryptoStrategy,exports[a10_0xbad57d(0x14e)]=CryptoStrategy;