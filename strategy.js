'use strict';function a10_0x37c9(_0x41cec3,_0x1fb243){const _0x21f22d=a10_0x21f2();return a10_0x37c9=function(_0x37c98d,_0x32072f){_0x37c98d=_0x37c98d-0x1bb;let _0x4b1994=_0x21f22d[_0x37c98d];return _0x4b1994;},a10_0x37c9(_0x41cec3,_0x1fb243);}const a10_0x1f15ad=a10_0x37c9;(function(_0x15d032,_0x389812){const _0xdb3287=a10_0x37c9,_0x546d41=_0x15d032();while(!![]){try{const _0x5663e6=parseInt(_0xdb3287(0x1c7))/0x1+-parseInt(_0xdb3287(0x1d0))/0x2*(parseInt(_0xdb3287(0x1da))/0x3)+-parseInt(_0xdb3287(0x1e5))/0x4+-parseInt(_0xdb3287(0x1e4))/0x5*(-parseInt(_0xdb3287(0x1c0))/0x6)+-parseInt(_0xdb3287(0x1e8))/0x7*(parseInt(_0xdb3287(0x1c2))/0x8)+parseInt(_0xdb3287(0x1cc))/0x9+parseInt(_0xdb3287(0x1dd))/0xa*(parseInt(_0xdb3287(0x1e1))/0xb);if(_0x5663e6===_0x389812)break;else _0x546d41['push'](_0x546d41['shift']());}catch(_0x40edff){_0x546d41['push'](_0x546d41['shift']());}}}(a10_0x21f2,0xe2a3a));Object[a10_0x1f15ad(0x1c6)](exports,a10_0x1f15ad(0x1ec),{'value':!![]}),exports[a10_0x1f15ad(0x1d9)]=void 0x0;const passport_strategy_1=require(a10_0x1f15ad(0x1ea)),factory_1=require(a10_0x1f15ad(0x1d3)),base_1=require(a10_0x1f15ad(0x1d1)),assert=require('assert'),constants_1=require('./crypto/constants'),validateWalletType=_0x2dd694=>typeof _0x2dd694==='string'&&Object[a10_0x1f15ad(0x1e2)](constants_1[a10_0x1f15ad(0x1d5)])[a10_0x1f15ad(0x1c3)](_0x2dd694);class CryptoStrategy extends passport_strategy_1['Strategy']{constructor(_0x2ceff3={}){const _0x3cb4a3=a10_0x1f15ad;super(),this[_0x3cb4a3(0x1d7)]='crypto',this[_0x3cb4a3(0x1bc)]=new factory_1['CryptoAuthFactory'](),this[_0x3cb4a3(0x1c1)]=this[_0x3cb4a3(0x1bc)][_0x3cb4a3(0x1df)](),this[_0x3cb4a3(0x1cf)]=_0x2ceff3[_0x3cb4a3(0x1cf)]||_0x3cb4a3(0x1d6);}async[a10_0x1f15ad(0x1be)](_0x2dc6fb){const _0x5e539a=a10_0x1f15ad,_0x13e043=_0x2dc6fb['headers'][_0x5e539a(0x1cd)],_0x5e8cbc=_0x2dc6fb[_0x5e539a(0x1bb)][_0x5e539a(0x1eb)]||constants_1[_0x5e539a(0x1d5)][_0x5e539a(0x1d4)];assert(validateWalletType(_0x5e8cbc),new base_1['BadRequestException'](_0x5e539a(0x1d8)));if(typeof _0x13e043!=='string')throw new base_1[(_0x5e539a(0x1ce))](_0x5e539a(0x1e7));const _0x43c67d=this[_0x5e539a(0x1bc)][_0x5e539a(0x1cb)](_0x5e8cbc);return _0x43c67d[_0x5e539a(0x1d2)]({'address':_0x13e043});}async['verifyResponse'](_0x2fa648,_0xe9bc32){const _0x4722fe=a10_0x1f15ad;assert(validateWalletType(_0xe9bc32['walletType']),new base_1['BadRequestException'](_0x4722fe(0x1d8)));const _0x332d1b=this[_0x4722fe(0x1bc)]['walletVerifier'](_0xe9bc32[_0x4722fe(0x1db)]),_0x52e91e=await _0x332d1b[_0x4722fe(0x1e3)](_0xe9bc32);return{'status':_0x52e91e['status'],'user':_0x52e91e[_0x4722fe(0x1c4)]?{'address':_0x52e91e[_0x4722fe(0x1c8)]}:undefined};}async[a10_0x1f15ad(0x1e0)](_0x14cfb9){const _0x2cb5de=a10_0x1f15ad,_0x5d03b6=_0x14cfb9[_0x2cb5de(0x1de)]||{},_0x38e503=_0x5d03b6[this[_0x2cb5de(0x1cf)]];try{if(!_0x38e503||typeof _0x38e503!==_0x2cb5de(0x1c9)){const _0x3db693=await this[_0x2cb5de(0x1be)](_0x14cfb9);return this[_0x2cb5de(0x1e6)](_0x14cfb9,_0x2cb5de(0x1bf),_0x3db693);}const {user:_0xc3e989,status:_0xdb17ab}=await this[_0x2cb5de(0x1e3)](_0x14cfb9,_0x38e503);if(_0xdb17ab&&_0xc3e989)return this['success'](_0xc3e989);return this['failWithChallenge'](_0x14cfb9,_0x2cb5de(0x1ca));}catch(_0x418a8c){if(_0x418a8c instanceof base_1[_0x2cb5de(0x1ce)])return this[_0x2cb5de(0x1e6)](_0x14cfb9,_0x418a8c[_0x2cb5de(0x1dc)]);throw _0x418a8c;}}async[a10_0x1f15ad(0x1e6)](_0x3e9849,_0x140990,_0x1ed2b0){const _0x34d1e4=a10_0x1f15ad;return _0x3e9849[_0x34d1e4(0x1c5)][_0x34d1e4(0x1c4)](0x191)[_0x34d1e4(0x1bd)]({'challenge':_0x1ed2b0,'message':_0x140990||_0x34d1e4(0x1e9)});}}function a10_0x21f2(){const _0x141b00=['1988vvBXjz','Unauthorized','passport-strategy','x-wallet-type','__esModule','headers','cryptoAuthFactory','json','getChallenge','Challenge','1716iuWUdH','baseCryptoAuth','48424ZfVKuI','includes','status','res','defineProperty','92532nOZIDY','address','object','Invalid\x20credentials','walletVerifier','16008750XhblUH','x-address','PublicException','responseField','2767040rVDMmH','./crypto/base','generateChallenge','./crypto/factory','EVM','WalletType','response','name','Invalid\x20wallet\x20type','Strategy','3pwgPGu','walletType','message','22299930xMPTEk','body','getBaseCryptoAuth','authenticate','11wqKrFy','values','verifyResponse','29615GMUgYV','7057468VYzCby','failWithChallenge','Address\x20is\x20required'];a10_0x21f2=function(){return _0x141b00;};return a10_0x21f2();}exports[a10_0x1f15ad(0x1d9)]=CryptoStrategy,exports['default']=CryptoStrategy;